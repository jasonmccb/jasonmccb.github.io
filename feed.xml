<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title></title>
    <description>True victory is not beating someone strong but being able to protect something important to you</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 28 Apr 2024 16:32:53 +1200</pubDate>
    <lastBuildDate>Sun, 28 Apr 2024 16:32:53 +1200</lastBuildDate>
    <generator>Jekyll v4.3.2</generator>
    
      <item>
        <title>Postgres connection maxed out for Hikari Connection Pool</title>
        <description>&lt;p&gt;Error:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;psql: error: connection to server on socket &quot;/var/run/postgresql/.s.PGSQL.5432&quot; failed: FATAL:  sorry, too many clients already
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Warning:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;com.zaxxer.hikari.pool.PoolBase(line:179) - HikariPool-1 - Failed to validate connection org.postgresql.jdbc.PgConnection@765d7657 (This connection has been closed.). Possibly consider using a shorter maxLifetime value.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Trouble shooting:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; ff76fc38b49a psql &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; &amp;lt;db_user&amp;gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &amp;lt;db_name&amp;gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT count(*) FROM pg_stat_activity;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Solution:&lt;br /&gt;
    Set a shorter maxLifetime (also idleTimeout if necessary) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setMaxLifetime(N * 60 * 1000)&lt;/code&gt;&lt;br /&gt;
    Or, set minimumIdle to 0 in worst case&lt;/p&gt;

&lt;p&gt;HikariCP document to set maxLifetime for reference:&lt;br /&gt;
    &lt;a href=&quot;https://github.com/brettwooldridge/HikariCP?tab=readme-ov-file#gear-configuration-knobs-baby&quot;&gt;https://github.com/brettwooldridge/HikariCP?tab=readme-ov-file#gear-configuration-knobs-baby&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Sun, 28 Apr 2024 16:00:00 +1200</pubDate>
        <link>http://localhost:4000/2024/04/28/Postgres-connection-maxed-out-issue/</link>
        <guid isPermaLink="true">http://localhost:4000/2024/04/28/Postgres-connection-maxed-out-issue/</guid>
        
        <category>Java</category>
        
        
      </item>
    
      <item>
        <title>npm install failed in Azure pipeline</title>
        <description>&lt;p&gt;Error:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    #8 [4/5] RUN npm install
    #8 18.80 npm ERR! code EMFILE
    #8 18.80 npm ERR! syscall open
    #8 18.80 npm ERR! path /root/.npm/_cacache/index-v5/a0/7a/7e48bcbef3e333c0cda8208f4902ea385bb700f4d8c414525a120c4bba14
    #8 18.80 npm ERR! errno -24
    #8 18.80 npm ERR! EMFILE: too many open files, open &apos;/root/.npm/_cacache/index-v5/a0/7a/7e48bcbef3e333c0cda8208f4902ea385bb700f4d8c414525a120c4bba14&apos;
    #8 18.85 
    #8 18.85 npm ERR! A complete log of this run can be found in: /root/.npm/_logs/2024-03-24T20_54_30_709Z-debug-0.log
    #8 ERROR: process &quot;/bin/sh -c npm install&quot; did not complete successfully: exit code: 232
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Failed attempts:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RUN ulimit -n 65536&lt;/code&gt; in Dockerfile&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker builder prune&lt;/code&gt; to clean the cache&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RUN npm install --sequential&lt;/code&gt; to inhibit parallelization&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Solution:&lt;br /&gt;
      &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker build --ulimit nofile=65536:65536&lt;/code&gt; in pipeline&lt;/p&gt;

</description>
        <pubDate>Sun, 31 Mar 2024 11:00:00 +1300</pubDate>
        <link>http://localhost:4000/2024/03/31/npm-install-failed/</link>
        <guid isPermaLink="true">http://localhost:4000/2024/03/31/npm-install-failed/</guid>
        
        <category>JavaScript</category>
        
        
      </item>
    
      <item>
        <title>Code Signing Certificate</title>
        <description>&lt;p&gt;There’s an industry wide change of where to store the private key of a code signing certificate.
Most if not all CAs have adopted and announced this change, e.g. DigiCert:
&lt;a href=&quot;https://knowledge.digicert.com/generalinformation/new-private-key-storage-requirement-for-standard-code-signing-certificates-november-2022.html&quot;&gt;https://knowledge.digicert.com/generalinformation/new-private-key-storage-requirement-for-standard-code-signing-certificates-november-2022.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;One common solution is to store the private key on CA’s HSM and use their cloud based solution for signing.
Generally we should never give others our private keys.
But in this particular case we can if the key is only used to sign codes and not for other purposes such as encryption, because the certificate of this key is granted by CA whose legitimacy is controlled by itself anyway.&lt;/p&gt;

&lt;p&gt;There’s a long guide for this cloud based signing solution including CI/CD integration if you’re using DigiCert:
&lt;a href=&quot;https://docs.digicert.com/en/digicert-keylocker/get-started.html&quot;&gt;https://docs.digicert.com/en/digicert-keylocker/get-started.html&lt;/a&gt;
But there’re some points to be aware of:&lt;/p&gt;

&lt;p&gt;1.&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smksp_registrar.exe register&lt;/code&gt; errors:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;BCryptRegisterProvider failed with error code 0xc0000022
BCryptAddContextFunction failed with error code 0xc0000022
BCryptAddContextFunctionProvider failed with error code 0xc0000022
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;solution:&lt;br /&gt;
  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smctl credentials save &amp;lt;API key&amp;gt; &amp;lt;Client authentication certificate password&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;2.&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smctl healthcheck&lt;/code&gt; failure:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Your client certificate path or password is incorrect. You will not be able to complete specific actions (such as sign, generate keypairs and approve releases) until these credentials are corrected.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;solution:&lt;br /&gt;
  Don’t use set command to set variables, instead, manually set it up in “environment variables”&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set SM_HOST=https://clientauth.one.digicert.com
set SM_CLIENT_CERT_FILE=C:\my_path\Certificate_pkcs12.p12
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3.”Azure pipeline cannot get thumbprint from local cert store” error:&lt;br /&gt;
cause:&lt;br /&gt;
  Azure Pipelines Agent (OrgName.AgentPoolName.AgentName) windows service cannot get the powershell result&lt;br /&gt;
solution:&lt;br /&gt;
  1. Make sure certificates are synced to key store by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smksp_cert_sync.exe&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;certmgr.msc&lt;/code&gt;&lt;br /&gt;
  2. Don’t use windows service, instead, use run.cmd in the agent&lt;br /&gt;
  3. Granting any permission to a certificate in “certlm.msc” won’t work&lt;/p&gt;

&lt;p&gt;4.”Cannot find certificate” error:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;##[error]C:\Program Files\Microsoft Visual Studio\2022\Enterprise\MSBuild\Microsoft\VisualStudio\v17.0\OfficeTools\Microsoft.VisualStudio.Tools.Office.targets(164,9): Error : Cannot find the certificate that matches the project system thumbprint.  To sign the application and deployment manifests, open the Project Designer, click the Signing page tab, select an existing certificate, and try again.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;solution:&lt;br /&gt;
  Don’t use MS-hosted agent, use self-hosted agent that has access to local certificate store. Remove codes below:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jobs:
  - job:
    pool:
      vmImage: &quot;windows-latest&quot;    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5.”internal consistency” error:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;##[error]C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Microsoft\VisualStudio\v16.0\OfficeTools\Microsoft.VisualStudio.Tools.Office.targets(328,9): Error MSB3482: An error occurred while signing: An internal consistency check failed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;solution:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;upgrade SignTool.exe to that in Windows-10 SDK&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;make sure early steps are set up properly&lt;/p&gt;

    &lt;p&gt;from:&lt;br /&gt;
    winsdksetup.exe (there’s an MSI installer for SignTool)&lt;br /&gt;
    C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\signtool.exe&lt;br /&gt;
  check:&lt;br /&gt;
    Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\ClickOnce\SignTool&lt;br /&gt;
  to:&lt;br /&gt;
    C:\Program Files (x86)\Microsoft SDKs\ClickOnce\SignTool\&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Thu, 29 Feb 2024 11:00:00 +1300</pubDate>
        <link>http://localhost:4000/2024/02/29/code-signing-certificiates/</link>
        <guid isPermaLink="true">http://localhost:4000/2024/02/29/code-signing-certificiates/</guid>
        
        <category>project management</category>
        
        
      </item>
    
      <item>
        <title>Move from MySql to PostgreSQL</title>
        <description>&lt;p&gt;&lt;strong&gt;Things to be changed as migrating from MySql to PostgreSQL&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;MySql&lt;/th&gt;
      &lt;th&gt;PostgreSQL&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;START TRANSACTION;, COMMIT;, ROLLBACK;&lt;/td&gt;
      &lt;td&gt;BEGIN;, COMMIT;, ROLLBACK;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;`id`&lt;/td&gt;
      &lt;td&gt;“id”&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;reserved keywords xxx&lt;/td&gt;
      &lt;td&gt;“xxx”&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;“…”&lt;/td&gt;
      &lt;td&gt;‘…’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;\”&lt;/td&gt;
      &lt;td&gt;”&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;\’&lt;/td&gt;
      &lt;td&gt;’’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;\n&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;case insensitive&lt;/td&gt;
      &lt;td&gt;case sensitive&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;USE my_db&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\c my_db&lt;/code&gt; or just remove it as it’s not needed&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;_binary&lt;/td&gt;
      &lt;td&gt;E’\xFFF’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;INSERT 1 TO BIT(X) column&lt;/td&gt;
      &lt;td&gt;INSERT B’1’ TO BIT(X) column&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;INSERT INSERT IGNORE INTO&lt;/td&gt;
      &lt;td&gt;INSERT INTO … ON CONFLICT ([COLUMN]) DO NOTHING&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LIMIT 10 OFFSET 20&lt;/td&gt;
      &lt;td&gt;OFFSET 20 FETCH FIRST 10 ROWS ONLY;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DELETE t1 FROM table_1 t1 JOIN table_2 t2 ON&lt;/td&gt;
      &lt;td&gt;DELETE FROM table_1 WHERE id NOT IN (SELECT … FROM table_2)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LAST_INSERT_ID()&lt;/td&gt;
      &lt;td&gt;INSERT…RETURNING id&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;a JOIN b JOIN c ON a.id=b.id AND b.id=c.id&lt;/td&gt;
      &lt;td&gt;a JOIN b ON a.id=b.id JOIN c ON b.id=c.id&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SELECT COUNT(col_a), col_b FROM …&lt;/td&gt;
      &lt;td&gt;SELECT COUNT(col_a), col_b FROM … GROUP BY col_b&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;NOW(),CURDATE(),CURTIME(),UNIX_TIMESTAMP()&lt;/td&gt;
      &lt;td&gt;CURRENT_TIMESTAMP,CURRENT_DATE,CURRENT_TIME, &lt;br /&gt; ROUND(EXTRACT(epoch FROM CURRENT_TIMESTAMP))&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;IFNULL(expr1, expr2)&lt;/td&gt;
      &lt;td&gt;COALESCE(expr1, expr2)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;if(boolean, integer, integer)&lt;/td&gt;
      &lt;td&gt;CASE WHEN boolean THEN integer ELSE integer END&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;#&lt;/td&gt;
      &lt;td&gt;–&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;CONCAT(str1, str2)&lt;/td&gt;
      &lt;td&gt;str1 || str2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;||&lt;/td&gt;
      &lt;td&gt;OR&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;GRANT ALL PRIVILEGES ON db_name.* TO ‘user_name’@’%’;&lt;/td&gt;
      &lt;td&gt;GRANT ALL PRIVILEGES ON DATABASE db_name TO user_name;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Database.initMySqlDb()&lt;/td&gt;
      &lt;td&gt;Database.initPostgresDb()&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Remove mysql dependency in POM&lt;/td&gt;
      &lt;td&gt;add Postgres dependency in POM&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

</description>
        <pubDate>Wed, 31 Jan 2024 20:00:00 +1300</pubDate>
        <link>http://localhost:4000/2024/01/31/Move-from-MySql-to-PostgreSQL/</link>
        <guid isPermaLink="true">http://localhost:4000/2024/01/31/Move-from-MySql-to-PostgreSQL/</guid>
        
        <category>SQL</category>
        
        
      </item>
    
      <item>
        <title>PUBLIC_URL in React is not dynamic</title>
        <description>&lt;p&gt;&lt;strong&gt;Symptom&lt;/strong&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PUBLIC_URL&lt;/code&gt; is a system variable defined in file .env and used by Create React App.&lt;br /&gt;
Once we run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm run build&lt;/code&gt;, this is the base URL as a static string.&lt;br /&gt;
It cannot be dynamically set in a configuration file at run time.&lt;br /&gt;
As a result, if two builds are using different PUBLIC_URL then they have to be built separately, which is bad for containerization.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;solution&lt;/strong&gt;&lt;br /&gt;
So far I have found no solution&lt;/p&gt;

</description>
        <pubDate>Sun, 31 Dec 2023 23:00:00 +1300</pubDate>
        <link>http://localhost:4000/2023/12/31/PUBLIC_URL-in-React-is-not-dynamic/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/12/31/PUBLIC_URL-in-React-is-not-dynamic/</guid>
        
        <category>React</category>
        
        
      </item>
    
      <item>
        <title>MongoDB upgrade error in .NET</title>
        <description>&lt;h3 id=&quot;upgrading-mongodb-driver-in-net-project-causing-dependent-assembly-error&quot;&gt;Upgrading MongoDB driver in .NET project causing dependent assembly error&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Error message&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  Calling constructor xxx.yyy()
 ---&amp;gt; System.TimeoutException: A timeout occurred after 30000ms selecting a server using CompositeServerSelector{ Selectors = WritableServerSelector, LatencyLimitingServerSelector{ AllowedLatencyRange = 00:00:00.0150000 }, OperationsCountServerSelector }. Client view of cluster state is { ClusterId : &quot;1&quot;, Type : &quot;Unknown&quot;, State : &quot;Disconnected&quot;, Servers : [{ ServerId: &quot;{ ClusterId : 1, EndPoint : &quot;Unspecified/localhost:27017&quot; }&quot;, EndPoint: &quot;Unspecified/localhost:27017&quot;, ReasonChanged: &quot;Heartbeat&quot;, State: &quot;Disconnected&quot;, ServerVersion: , TopologyVersion: , Type: &quot;Unknown&quot;, HeartbeatException: &quot;MongoDB.Driver.MongoConnectionException: An exception occurred while opening a connection to the server. ---&amp;gt; System.IO.FileLoadException: Could not load file or assembly &apos;System.Runtime.CompilerServices.Unsafe, Version=4.0.4.1, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&apos; or one of its dependencies. The located assembly&apos;s manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;troubleshoot&lt;/strong&gt;&lt;br /&gt;
    - Referencing the new library &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;System.Runtime.CompilerServices.Unsafe.dll&lt;/code&gt; or any Mongo related libraries in the IDE doesn’t help, either via NuGet installation or direct file reference.&lt;br /&gt;
	&lt;img src=&quot;/images/project.reference.png&quot; alt=&quot;my_image&quot; /&gt;&lt;br /&gt;
    - Clearing the NuGet cache (as in %USERPROFILE%.nuget) doesn’t help.&lt;br /&gt;
    &lt;img src=&quot;/images/NuGet.options.png&quot; alt=&quot;my_image&quot; /&gt;&lt;br /&gt;
    - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;obj\project.assets.json&lt;/code&gt; shows the resolved dependencies:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Threading.Tasks.Extensions/4.5.4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;package&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dependencies&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Runtime.CompilerServices.Unsafe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4.5.3&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;frameworkAssemblies&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mscorlib&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;compile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lib/net461/System.Threading.Tasks.Extensions.dll&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;runtime&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lib/net461/System.Threading.Tasks.Extensions.dll&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;......&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Memory/4.5.5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;package&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dependencies&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Buffers&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4.5.1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Numerics.Vectors&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4.5.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Runtime.CompilerServices.Unsafe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4.5.3&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;......&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Threading.Tasks.Extensions/4.5.4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;package&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dependencies&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;System.Runtime.CompilerServices.Unsafe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4.5.3&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;frameworkAssemblies&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;mscorlib&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;compile&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lib/net461/System.Threading.Tasks.Extensions.dll&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;runtime&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lib/net461/System.Threading.Tasks.Extensions.dll&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;cause&lt;/strong&gt;&lt;br /&gt;
    .NET framework libraries are using an old version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;System.Runtime.CompilerServices.Unsafe.dll&lt;/code&gt; e.g. 4.5.3, while &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MongoDB.Driver.Core&lt;/code&gt; is using a new version 5.0.0. NuGet resolves this conflict to the old version. It may happen again when there’s an upgrade in packages (MongoDB) or framework (.NET).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;solution&lt;/strong&gt;&lt;br /&gt;
    Add binding redirect to each project referencing the project having the Mongo upgrade to force it to use higher version e.g. 6.0.0.0.&lt;br /&gt;
    Follow the blog: https://nickcraver.com/blog/2020/02/11/binding-redirects/ &lt;br /&gt;
    Note that assembly version differs from NuGet package version, e.g. (4.0.4.1 ==&amp;gt; 4.5.3)&lt;/p&gt;

</description>
        <pubDate>Fri, 24 Nov 2023 17:00:00 +1300</pubDate>
        <link>http://localhost:4000/2023/11/24/MongoDB-upgrade-error-in-.NET/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/11/24/MongoDB-upgrade-error-in-.NET/</guid>
        
        <category>MongoDB</category>
        
        
      </item>
    
      <item>
        <title>Docker-compose port mapping</title>
        <description>&lt;p&gt;&lt;strong&gt;How to route network traffic from same port to different containers&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;How to route network traffic to different containers if only port 443 is allowed from external?&lt;br /&gt;
1. If there’s only one domain and one port, then reverse proxy may be necessary for URL based routing.&lt;br /&gt;
2. If we have different domains but same port, then we can either:\&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Use port forwarding to redirect traffics to the docker host IP with different ports, mapped by docker compose file. -or-&lt;/li&gt;
  &lt;li&gt;Assign different IPs for the containers, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;- ports: 1.2.3.4:443:443&lt;/code&gt; (IP:Host-port:Container-port)&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Mon, 30 Oct 2023 21:00:00 +1300</pubDate>
        <link>http://localhost:4000/2023/10/30/docker-compose-port-mapping/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/10/30/docker-compose-port-mapping/</guid>
        
        <category>docker</category>
        
        
      </item>
    
      <item>
        <title>Azure pipeline pitfalls</title>
        <description>&lt;p&gt;&lt;strong&gt;Some Azure pipeline pitfalls to be aware of&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;1. In conditions, or conditional insertion, use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${ { var }}&lt;/code&gt;, otherwise use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$(var)&lt;/code&gt; for variables.&lt;br /&gt;
	Note the difference of the script variables denoted as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$var&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${var}&lt;/code&gt;.&lt;br /&gt;
	E.g.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;na&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;${ { if eq( parameters.env, &apos;prod&apos;) }}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;myEnv&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;prod&apos;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;${ { if eq( parameters.env, &apos;dev&apos;) }}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;myEnv&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;dev&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;2. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker run&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker stop&lt;/code&gt; may return before the command actually finishes.&lt;br /&gt;
	Possible solutions:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh -c cmd1.sh &amp;amp;&amp;amp; wait&lt;/code&gt; to wait for the background processes to finish&lt;/li&gt;
  &lt;li&gt;use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ &quot;$(docker ps -q -f id=$ID)&quot; ] &amp;amp;&amp;amp; docker wait $ID&lt;/code&gt; for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker stop&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;use loop and sleep&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3. If “script” exits with 1 then the “succeeded()” in the following step will fail. E.g.&lt;br /&gt;
	&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ $? -ne 0 ] &amp;amp;&amp;amp; echo &apos;&apos;&lt;/code&gt; can exit 1&lt;/p&gt;

&lt;p&gt;4. After copying to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$(Build.ArtifactStagingDirectory)&lt;/code&gt;, and calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PublishPipelineArtifact@1&lt;/code&gt;, then downloading with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DownloadPipelineArtifact@2&lt;/code&gt;, the file permissions may be changed to readonly.&lt;br /&gt;
	Possible solution: Grant execution access after downloading from artifact&lt;/p&gt;

&lt;p&gt;5. If we use “git commit –amend” then some files may not get updated when running azure pipeline.&lt;br /&gt;
	E.g. The change history of file content is like: a-&amp;gt;b-&amp;gt;b&lt;/p&gt;

&lt;p&gt;6. Using a “cp” command in “script” to copy stuff to a non-existing directory will create the directory and then returns without copying.&lt;br /&gt;
	E.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cp myFile ./non-existing-dir/&lt;/code&gt;&lt;/p&gt;

</description>
        <pubDate>Fri, 29 Sep 2023 16:00:00 +1300</pubDate>
        <link>http://localhost:4000/2023/09/29/Azure-pipeline-pitfalls/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/09/29/Azure-pipeline-pitfalls/</guid>
        
        <category>Azure</category>
        
        
      </item>
    
      <item>
        <title>CSS table max height not working</title>
        <description>&lt;p&gt;&lt;strong&gt;CSS &amp;lt;td&amp;gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-height&lt;/code&gt; is not working for large text&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;1. CSS &amp;lt;td&amp;gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-height&lt;/code&gt; is not working for large text. E.g.
&lt;img src=&quot;/images/css-td-max-height-not-working.png&quot; alt=&quot;my_image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;2. It can be achieved by setting the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;display&lt;/code&gt; property. E.g.
&lt;img src=&quot;/images/css-td-max-height-working.png&quot; alt=&quot;my_image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;3. The easiest way may be using &amp;lt;div&amp;gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-height&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;overflow&lt;/code&gt;&lt;/p&gt;

</description>
        <pubDate>Mon, 28 Aug 2023 21:00:00 +1200</pubDate>
        <link>http://localhost:4000/2023/08/28/CSS-table-max-height-not-working/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/08/28/CSS-table-max-height-not-working/</guid>
        
        <category>CSS</category>
        
        
      </item>
    
      <item>
        <title>Some hints for Azure pipeline</title>
        <description>&lt;p&gt;&lt;strong&gt;Below are some hints to use Azure pipeline&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;1. If a variable is dependent on another, then the latter should be a constant. If both are evaludated from a non-constant expression then the value may not be correct. E.g.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;na&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;a+1&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;b+1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;2. Quote the parameters otherwise the value may not be considered as string. &lt;br /&gt;
E.g. stage S1 is fine whereas S2 will throw an error.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;na&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;envName&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;displayName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;environment name&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;prod&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;prod&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;S1&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;eq(&apos;${{parameters.envName}}&apos;, &apos;prod&apos;)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;S2&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;eq( ${{parameters.envName}} , &apos;prod&apos;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;3. Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;|&lt;/code&gt; for convenience. E.g.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;na&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;and (&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;succeeded(),&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;eq(&apos;$(version)&apos;, &apos;1.2&apos;)&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;echo aa&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;echo bb&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;4. Use single quotes to escape &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:&lt;/code&gt; in script. &lt;br /&gt;
E.g. Script S1 is fine whereas S2 throws errors&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TODO:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;tests&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;here&apos;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;displayName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;S1&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo &apos;&quot;TODO&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Add tests&quot; here&apos;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;displayName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;S2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;5. Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dependsOn&lt;/code&gt; to ensure job dependency. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;succeeded()&lt;/code&gt; does not ensure that. E.g.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yml&quot; data-lang=&quot;yml&quot;&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;job&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;j1&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;displayName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Build app&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;job&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;j2&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;displayName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deploy app&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;dependsOn&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;j1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Thu, 27 Jul 2023 10:00:00 +1200</pubDate>
        <link>http://localhost:4000/2023/07/27/some-hints-of-azure-pipeline/</link>
        <guid isPermaLink="true">http://localhost:4000/2023/07/27/some-hints-of-azure-pipeline/</guid>
        
        <category>Azure</category>
        
        
      </item>
    
  </channel>
</rss>
